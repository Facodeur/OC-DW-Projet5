"use strict";var contenuePanier=document.getElementById("stock-panier"),prixTotalPanier=0;function displayPanier(){prixTotalPanier=0,contenuePanier.innerHTML='<div class="border-bottom mb-4">\n        <h4 class="col-4 font-weight-bold">Votre panier</h4>\n    </div>';var e=getPanier(),n=!0,t=!1,a=void 0;try{for(var o,r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var i=o.value,c=i.prix/100,d=c*i.count;prixTotalPanier+=d;var l='<div class="row border-bottom mb-4">\n                    <div class="col-md-3">\n                            <img id="image" src="'.concat(i.img,'" class="card-img mb-3" alt="photo ').concat(i.name,'">\n                    </div>\n                    <div class="col-md-3">\n                        <h5 class="card-title">').concat(i.name,'</h5>\n                        <p class="card-text">').concat(i.vernis,'</p>\n                        <p class="card-text">').concat(c.toFixed(2),'€</p>\n                    </div>\n                    <div class="d-flex flex-row">\n                        <span onclick="pushOneItem(event.currentTarget)" data-id="').concat(i.id,'" data-vernis="').concat(i.vernis,'" aria-label="ajoute"><i class="fas fa-plus-circle"></i></span>\n                        <p class="card-text">').concat(i.count,'</p>\n                        <span onclick="removeOneItem(event.currentTarget)" data-id="').concat(i.id,'" data-vernis="').concat(i.vernis,'" aria-label="diminu"><i class="fas fa-minus-circle"></i></span>\n                    </div>\n                    <div class="col-md-2">\n                        <p class="card-text prix-total">').concat(d,' €</p>\n                        <button onclick="removeItem(event.currentTarget)" data-id="').concat(i.id,'" data-vernis="').concat(i.vernis,'" type="button" class="close" aria-label="Close">\n                            <i class="fas fa-trash-alt"></i>\n                        </button>\n                    </div>\n                </div>');contenuePanier.innerHTML+=l}}catch(e){t=!0,a=e}finally{try{n||null==r.return||r.return()}finally{if(t)throw a}}checkPanierVide(),displayPrixTotal(),showTotalInPanier()}function removeItem(e){var n=getPanier(),t=e.dataset.id,a=e.dataset.vernis,o=n.filter(function(e){if(e.id!=t||e.vernis!=a)return!0});savePanier(o),displayPanier()}function displayPrixTotal(){var e=document.querySelector(".prix"),n=document.querySelector(".total-prix");e.textContent=prixTotalPanier+"€",n.textContent=prixTotalPanier+"€",console.log(prixTotalPanier)}function checkPanierVide(){0===prixTotalPanier&&(contenuePanier.innerHTML='<div class="text-center">\n            <h2>Votre panier est vide</h2>\n        </div>',document.getElementById("total-form").classList.add("d-none"),localStorage.removeItem("panier"))}function pushOneItem(e){addOrRemoveOneItem(e,!0)}function removeOneItem(e){addOrRemoveOneItem(e,!1)}function addOrRemoveOneItem(e,n){var t=getPanier(),a=e.dataset.id,o=e.dataset.vernis,r=!0,i=!1,c=void 0;try{for(var d,l=t[Symbol.iterator]();!(r=(d=l.next()).done);r=!0)panierItem=d.value,panierItem.id==a&&panierItem.vernis==o&&(n?panierItem.count++:1<panierItem.count&&panierItem.count--)}catch(e){i=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw c}}savePanier(t),displayPanier()}displayPanier();var formCommand=document.getElementById("form"),btnCommand=document.getElementById("command");btnCommand.addEventListener("click",function(){formCommand.classList.remove("d-none"),btnCommand.classList.add("d-none")});var panier=getPanier(),products=[];panier.forEach(function(e){products.push(e.id),console.log("dans le forEach",e.id)}),console.log("produits = ",products);var form=document.getElementById("form-command"),btnValidCommand=document.getElementById("btn-valid-command");btnValidCommand.addEventListener("click",submitOrder);var options={method:"POST",body:JSON.stringify({contact:{firstName:form.firstName.value,lastName:form.lastName.value,address:form.address.value,city:form.city.value,email:form.email.value},products:products}),headers:{"Content-type":"application/json; charset=UTF-8"}};function submitOrder(e){e.preventDefault(),fetch("http://localhost:3000/api/furniture/order",options).then(function(e){return e.ok?e.json():Promise.reject(e.status)}).then(function(e){var n='\x3c!-- Modal --\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">\n            <div class="modal-dialog modal-dialog-centered" role="document">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title" id="exampleModalLongTitle">Confirmation de commande</h5>\n                        <button onclick="pageAccueil()" type="button" class="close" data-dismiss="modal" aria-label="Close">\n                            <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>\n                    <div class="modal-body">\n                        Nous vous remercions de votre commande N°<strong>'.concat(e.orderId,"</strong> d'un montant de <strong>").concat(prixTotalPanier,' €</strong>. Nous vous tiendrons informé par e-mail \n                        lorsque les articles de votre commande auront été expédiés.\n                        </div>\n                        <div class="modal-footer">\n                        <button onclick="pageAccueil()" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>\n                    </div>\n                </div>\n            </div>\n        </div>');document.querySelector(".container").innerHTML=n,$("#modalConfirm").modal("show"),console.log(e)}).catch(function(e){return console.log("Erreur message : ".concat(e))})}function pageAccueil(){document.location.href="index.html",localStorage.clear()}